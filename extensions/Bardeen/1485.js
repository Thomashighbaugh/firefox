"use strict";(self.webpackChunkbardeen_browser_extension=self.webpackChunkbardeen_browser_extension||[]).push([[1485],{55567:(e,t,n)=>{n.d(t,{k:()=>r,Z:()=>o}),n(68796);const a={api:null},r=e=>{a.api=e},l=new Proxy(a,{get(e,t){if(null===e.api)throw new Error("You must first call setAPI");return e.api[t]}});window.api=l;const o=l},28871:(e,t,n)=>{n.d(t,{B:()=>o});var a=n(2784),r=(n(68796),n(78975)),l=n(55567);const o=()=>{const[e,t]=a.useState(void 0),n=a.useRef(e),o=a.useCallback((()=>l.Z.systemBootStatusGet().then((e=>{n.current&&n.current.loading&&!e.loading&&!e.error&&(l.Z.appWindowHide().then((()=>l.Z.appWindowShow())),n.current=void 0),n.current=e,t(e),(e.loading||e.error)&&setTimeout(o,250)}))),[]);return a.useEffect((()=>{o()}),[o]),e&&e.loading?e.error?a.createElement(r.LoadingOverlay,{button:a.createElement(r.BardeenButton,{type:"secondary",mode:"dark",onClick:()=>l.Z.systemBootRetry(),icon:{icon:"RepeatBold"}},"Retry"),loadingVisible:!1,message:"Failed to load the engine",error:e.error}):a.createElement(r.LoadingOverlay,{message:`[${e.tasksDone}/${e.tasksTotal}] ${e.message}`}):null}},50405:(e,t,n)=>{n.d(t,{_:()=>o});var a=n(2784),r=n(78975),l=n(34005);const o=e=>{const{children:t}=e,[{isOpen:n,variant:o,message:i,description:c,autoHide:s},{closeSnackbar:m}]=(0,l.E0)();return a.createElement(a.Fragment,null,t,a.createElement(r.BardeenNotification,{open:n||!1,variant:o,message:i,description:c,onClose:m,autoHide:s}))}},51485:(e,t,n)=>{n.r(t),n.d(t,{AuthWindow:()=>m,BardeenStyleProvider:()=>o.BardeenStyleProvider,PopupWindow:()=>u.P,PreviewTableWindow:()=>Je,PromptGmailWindow:()=>Xe,PromptsWindow:()=>v,SettingsWindow:()=>Ve,bootstrap:()=>et,setAPI:()=>i.k});var a=n(2784),r=n(28316),l=n(68796),o=n(78975),i=n(55567),c=n(79692);const s=(0,c.Z)({loginPrompt:Object.assign(Object.assign({},o.center),{height:"100%"}),loginFrame:{width:"400px"}}),m=()=>{var e;const t=s(),[n,r]=(0,a.useState)(null),[l,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)("Click the bardeen button to continue"),d=(0,a.useRef)(null),p=(null==n?void 0:n.entries.length)||0,g=((null==n?void 0:n.entries)||[]).reduce(((e,t)=>e+(t.completed?1:0)),0),E=null==n||n.entries.every((e=>e.completed)),y=n&&"close"!==((null===(e=n.meta)||void 0===e?void 0:e.postAuthAction)||"close");return(0,a.useEffect)((()=>{let e=0;return function t(){i.Z.authGetStatus().then((e=>{if(e)d.current=e,r(e);else{const e=Object.assign({},d.current);e.entries=e.entries.map((e=>Object.assign({},e,{active:!1,completed:!0,error:null}))),r(e)}})).finally((()=>{e=window.setTimeout(t,100)}))}(),()=>{window.clearTimeout(e)}}),[r,d]),(0,a.useEffect)((()=>{if(E&&y){const e=e=>{(e.clientX<0||e.clientY<0||e.clientX>=window.innerWidth||e.clientY>=window.innerHeight)&&i.Z.authDismissUI()},t=()=>{i.Z.authDismissUI()},n=e=>{"Alt"===e.key&&i.Z.authDismissUI()};return window.addEventListener("blur",t),document.addEventListener("keydown",n),document.addEventListener("mouseout",e),()=>{window.removeEventListener("blur",t),document.removeEventListener("keydown",n),document.removeEventListener("mouseout",e)}}}),[E,y]),(0,a.useEffect)((()=>{window.document.title=`Connected: ${g} of ${p}`}),[p,g]),(0,a.useEffect)((()=>{var e,t,a;E&&n&&y&&"popup-arrow"===(null===(e=n.meta)||void 0===e?void 0:e.postAuthAction)&&(c(!0),(null===(t=n.meta)||void 0===t?void 0:t.postAuthMessage)&&u(null===(a=n.meta)||void 0===a?void 0:a.postAuthMessage))}),[y,E,n]),a.createElement(a.Fragment,null," ",a.createElement("div",{className:t.loginPrompt},n?a.createElement(o.ConnectApplicationsCard,{className:t.loginFrame,onCancel:i.Z.authCancel,onContinue:i.Z.authContinue,onExecuteOne:i.Z.authContinueOne,onFocusActive:i.Z.authFocusActive,popupMode:!1,status:n}):null),a.createElement(o.BardeenExtensionPointingPopup,{visible:l},m))};var u=n(1740);const d=o.MetricsMap.boxModel.spacing,p=(0,c.Z)({form:{"& > div":{marginBottom:".5rem"}},logoHeader:{marginBottom:`${d.l}px`,display:"flex",alignItems:"center"},logoTitle:{fontSize:o.MetricsMap.typography.size.xl,lineHeight:`${o.MetricsMap.typography.lineHeight.m} px`,fontWeight:o.MetricsMap.typography.weight.normal,marginLeft:"10px"},promptsForm:Object.assign(Object.assign({},o.centerVert),{flexDirection:"column"}),grid:{display:"flex"},card:{width:"600px",padding:"2rem !important",textAlign:"center","& > div > *":{padding:"1rem 0"}},formBtn:{"&:not(:last-child)":{marginRight:`${d.s}px`}}}),g=e=>{const{layout:t}=e,[n,r]=a.useState(null),c=p(),s=(e,t)=>{r((n=>Object.assign(Object.assign({},n),{[t]:e})))};return a.createElement("form",{onSubmit:()=>{if(n)return Object.keys(n).some((e=>!n[e]))?void 0:i.Z.promptSubmit(n)}},t.fields.map((e=>{const t=!n||!(!n||!(e.name in n))&&!n[e.name].trim();switch(e.type){case l.SystemPromptFieldType.Text:return a.createElement(o.BardeenFormItem,{labelText:e.label,required:!0,error:t,helperText:t?"This field cannot be empty!":""},a.createElement(o.BardeenInput,{onChange:t=>s(t,e.name),value:(null==n?void 0:n[e.name])||""}));case l.SystemPromptFieldType.Password:return a.createElement(o.BardeenFormItem,{labelText:e.label,required:!0,error:t,helperText:t?"This field cannot be empty!":""},a.createElement(o.BardeenInput,{type:"password",onChange:t=>s(t,e.name),value:(null==n?void 0:n[e.name])||""}));case l.SystemPromptFieldType.TextArea:return a.createElement(o.BardeenFormItem,{labelText:e.label,required:!0,error:t,helperText:t?"This field cannot be empty!":""},a.createElement("textarea",{onChange:t=>s(t.target.value,e.name),rows:10,style:{width:"100%",height:"auto"},value:(null==n?void 0:n[e.name])||""}))}})),a.createElement("div",null,a.createElement(o.BardeenButton,{className:c.formBtn,type:"primary",htmlType:"submit"},"Submit"),a.createElement(o.BardeenButton,{className:c.formBtn,onClick:()=>(r(null),i.Z.promptCancel())},"Cancel")))};var E=n(213),y=n.n(E);function h(e){return a.createElement("a",Object.assign({},e,{target:"_blank"}))}const b=e=>a.createElement(y(),{className:e.className,source:e.source,escapeHtml:!1,renderers:{link:h}}),v=()=>{const e=p(),t=String(window.location.hash).substr(1),n=t?JSON.parse(atob(t)):{fields:[],logo:"",description:"",title:"Invalid layout data"};return a.createElement("div",{className:e.promptsForm},a.createElement("div",{className:e.logoHeader},a.createElement(o.BardeenAvatar,{size:52,src:n.logo,variant:"square"}),a.createElement("span",{className:e.logoTitle},n.title)),a.createElement(o.BardeenCard,{className:e.card},n.description?a.createElement("div",{className:e.logoHeader},a.createElement(o.Text,{variant:"body"},a.createElement(b,{source:n.description}))):null,a.createElement(g,{layout:n})))};var f=n(62833),k=n(59726),C=n(6277),B=n(69378),w=n.n(B);const x=o.MetricsMap.boxModel.spacing,S=(0,c.Z)({sameHeight:{display:"flex",flexWrap:"wrap",flexFlow:"row wrap","& > *":{flexGrow:1,alignItems:"stretch","& > *":{height:"100%"}}},marginBottom:{"&.MuiTextField-root":{marginBottom:"16px"}},cardWrapper:{display:"flex",flexDirection:"column"},cardHeader:{display:"flex",alignItems:"center",borderBottom:`1px solid ${o.ColorMap.base[15]}`},cardTitle:{flex:1},cardContent:{display:"flex",marginTop:`${x.m}px`},cardAvatar:{marginRight:`${x.s}px`},grid:{display:"grid",columnGap:"1rem",rowGap:"1rem",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))"}}),T=e=>{const{plugins:t,onActivate:n,onShowMore:r}=e,[l,i]=a.useState(""),[c,s]=a.useState(!1),m=S(),u=a.useRef(null),d=(l||"").toLowerCase(),p=t.filter((e=>-1!==e.description.toLowerCase().indexOf(d)||-1!==e.name.toLowerCase().indexOf(d)));return a.createElement("div",null,a.createElement(o.BardeenInput,{value:l,className:m.marginBottom,placeholder:"Search integrations ...",size:"l",fullWidth:!0,isSearchable:!0,onChange:e=>{i(e)}}),a.createElement(o.BardeenModal,{open:c,primaryButton:"Ok",secondaryButton:"Cancel",footerVariant:"buttons",secondaryCallback:()=>s(!1),primaryCallback:()=>{s(!1),u.current&&n(u.current)}},a.createElement(o.Title,{variant:"h4"},"Security & Privacy"),a.createElement(o.Text,{variant:"body"},a.createElement("p",null,"Bardeen needs to connect to your apps in order to access data and run actions with their APIs."),a.createElement("br",null),a.createElement("p",null,a.createElement("span",null,"Learn about privacy "),a.createElement("a",{href:"https://bardeen.ai/privacy-policy/",target:"_blank"},"here"),"."))),a.createElement("div",{className:m.grid},p.map((e=>a.createElement(o.BardeenCard,{hoverable:!0,key:e.id,variant:"outlined",onClick:()=>{return(t=e).auth?(e=>{s(!0),u.current=e})(t):(e=>{n(e)})(t);var t}},a.createElement("div",{className:m.cardWrapper},a.createElement("div",{className:m.cardHeader},a.createElement(o.Title,{variant:"h4",className:m.cardTitle},e.name),a.createElement(o.BardeenButton,{type:"flat",onClick:t=>((e,t)=>{t.preventDefault(),t.stopPropagation(),r(e)})(e,t)},"More")),a.createElement("div",{className:m.cardContent},a.createElement(o.BardeenAvatar,{className:m.cardAvatar,src:e.icon,alt:e.name+" Logo"}),a.createElement(o.Text,{variant:"body"},e.description))))))))},Z=e=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Catalog",subTitle:"Available integrations"}),a.createElement(T,Object.assign({},e))));var M=n(11776),N=n(38402),A=n(3806),I=n(49378),O=n(82113),P=n(9520),$=function(e,t,n,a){return new(n||(n=Promise))((function(r,l){function o(e){try{c(a.next(e))}catch(e){l(e)}}function i(e){try{c(a.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};const F=({filter:e})=>{const t=a.useRef(0),[n,r]=a.useState([]),l=()=>$(void 0,void 0,void 0,(function*(){return r(yield i.Z.exceptionList())})),c=e=>$(void 0,void 0,void 0,(function*(){return r(yield i.Z.exceptionRecover(e.id))})),s=e=>$(void 0,void 0,void 0,(function*(){return r(yield i.Z.exceptionDismiss(e.id))}));(0,o.useEffectOnce)((()=>(l(),t.current=window.setInterval(l,1e3),()=>{window.clearInterval(t.current)})));const m=n.filter((t=>!t.message.includes("charAt")&&(!e||!e.pluggableId||t.source.manifest&&t.source.manifest.id===e.pluggableId)));return a.createElement("div",null,a.createElement(M.Z,null,m.map((e=>a.createElement(R,{key:e.id,e,onDelete:s,onRetry:c})))),n.length>0?a.createElement(o.BardeenButton,{onClick:()=>$(void 0,void 0,void 0,(function*(){yield i.Z.exceptionDismissAll(),r([])}))},"Clear Errors"):"No errors!")};function L(e){if(t=e,"[object Object]"!==Object.prototype.toString.call(t)&&!Array.isArray(e))return String(e);var t;try{return JSON.stringify(e,null,2)}catch(e){return"CIRCULAR JSON"}}const R=e=>{var t;const[n,r]=a.useState(!1),{e:l,onDelete:i,onRetry:c}=e,s=a.createElement(o.BardeenButton,{size:"s",type:"primary",key:"recover",onClick:()=>c(l)},"Recover"),m=[...l.recoverable?[s]:[],a.createElement(o.BardeenButton,{size:"s",key:"delete",onClick:()=>i(l),icon:{icon:"TrashBinOutline"}})];return a.createElement(N.Z,{button:!0,key:l.id,onClick:()=>r(!n)},a.createElement(A.Z,null,l.source.manifest?a.createElement(o.BardeenIcon,{icon:{url:l.source.manifest.icon}}):a.createElement(o.BardeenIcon,{color:o.ColorMap.strawberry.base,icon:{icon:"RadioExclamationBold"}})),a.createElement(I.Z,{primary:a.createElement("div",null,null===(t=l.source.manifest)||void 0===t?void 0:t.name," ",l.source.operation,a.createElement("div",null,l.message)),secondary:l.details?a.createElement(O.Z,{in:n,timeout:"auto",unmountOnExit:!0},a.createElement("pre",null,L(l.details))):null}),a.createElement(P.Z,null,m))},H=a.memo((()=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Errors",subTitle:"Overview of system errors and warnings"}),a.createElement(F,null)))));var W=n(85256),j=n(61454);const D=o.MetricsMap.boxModel.spacing,_=(0,j.createUseStyles)({badge:{display:"inline-flex",justifyContent:"center",alignItems:"center",height:"20px",minWidth:"20px",padding:`${D.base}px`,margin:`0 ${D.base}px`,borderRadius:"10px",backgroundColor:o.ColorMap.strawberry.base,boxShadow:"0 0 0 1px #fff",lineHeight:`${o.MetricsMap.typography.lineHeight.l}px`}}),z=e=>{const t=a.useRef(0),{filter:n,button:r}=e,[l,c]=a.useState([]),s=_(),m=a.useCallback((()=>i.Z.exceptionList().then((e=>{c(e)}))),[]),u=a.useMemo((()=>l.filter((e=>!e.message.includes("charAt")&&(!n||!n.pluggableId||e.source.manifest&&e.source.manifest.id===n.pluggableId)))),[l,n]);(0,o.useEffectOnce)((()=>(t.current=window.setInterval(m,1e3),m(),()=>{window.clearInterval(t.current)})));const d=a.useMemo((()=>a.createElement("span",{className:s.badge},a.createElement(o.Text,{variant:"caption",color:"base-white"},u.length))),[s,u.length]);return 0===u.length?null:r?a.createElement(o.BardeenButton,{size:"s",onClick:i.Z.openErrors,title:"An error occurred on BARDEEN"},a.createElement(o.BardeenIcon,{color:o.ColorMap.strawberry.base,icon:{icon:"RadioExclamationBold"}}),d):d},U=e=>{const{onRemove:t,onShowSettings:n,plugins:r,pluginsFailed:l}=e,[i,c]=a.useState({open:!1,title:""}),s=a.useCallback((()=>{const{open:e,primaryButton:t,secondaryButton:n,title:r,content:l,primaryCallback:c,secondaryCallback:s}=i;return a.createElement(o.BardeenModal,{variant:"popper",open:e||!1,primaryButton:t,secondaryButton:n,footerVariant:"buttons",title:r,content:l,primaryCallback:c,secondaryCallback:s})}),[i]);return a.createElement(a.Fragment,null,0===l.length?null:a.createElement(a.Fragment,null,a.createElement(o.BardeenPageHeader,{title:"Failed Integrations"}),a.createElement(M.Z,null,l.map(((e,n)=>{const r=[];return r.push(a.createElement(a.Fragment,{key:"do-remove"},a.createElement(o.BardeenButton,{size:"s",icon:{icon:"TrashBinOutline"},onClick:()=>{c({open:!0,primaryButton:"Yes",secondaryButton:"No",secondaryCallback:()=>c({open:!1}),primaryCallback:()=>{(e=>{t(e.id)})(e),c({open:!1})},title:"Are you sure you want to remove this plugin?"})}}))),a.createElement(a.Fragment,{key:e.id},n>0?a.createElement(W.Z,{component:"li"}):null,a.createElement(N.Z,null,a.createElement(A.Z,null,a.createElement(o.BardeenAvatar,{src:e.icon,variant:"square"})),a.createElement(I.Z,{primary:e.name,secondary:a.createElement("span",{style:{color:"#F00"}},e.reason)}),a.createElement(P.Z,null,r)))}))),a.createElement("hr",null)),a.createElement(o.BardeenPageHeader,{title:"My Integrations",subTitle:"Integrations registered on my account"}),a.createElement(M.Z,null,r.map(((e,r)=>{var l,i,s,m,u;const d=[];e.manifest.config&&d.push(a.createElement(o.BardeenButton,{key:"do-settings",size:"s",onClick:()=>(e=>{n(e)})(e)},"Configure"));const p={pluggableId:e.id};return d.push(a.createElement(a.Fragment,{key:"do-exception"},a.createElement(z,{button:!0,filter:p,onClick:()=>{c({open:!0,primaryButton:"Close",title:"Exceptions",content:a.createElement(F,{filter:p}),primaryCallback:()=>c({open:!1})})}}))),(null===(l=e.manifest.instance)||void 0===l?void 0:l.singleton)||d.push(a.createElement(a.Fragment,{key:"do-remove"},a.createElement(o.BardeenButton,{size:"s",icon:{icon:"TrashBinOutline"},onClick:()=>{c({open:!0,primaryButton:"Yes",secondaryButton:"No",secondaryCallback:()=>c({open:!1}),primaryCallback:()=>{(e=>{t(e.id)})(e),c({open:!1})},title:"Are you sure you want to remove this plugin?"})}}))),a.createElement(a.Fragment,{key:e.id},r>0?a.createElement(W.Z,{component:"li"}):null,a.createElement(N.Z,null,a.createElement(A.Z,null,a.createElement("div",null,a.createElement(o.BardeenAvatar,{src:e.manifest.icon,variant:"square"}),(null===(i=e.manifest.accountInfo)||void 0===i?void 0:i.icon)?a.createElement(o.BardeenAvatar,{src:null===(s=e.manifest.accountInfo)||void 0===s?void 0:s.icon,variant:"circular"}):null)),a.createElement(I.Z,{primary:`${e.manifest.name} ${(null===(m=e.manifest.accountInfo)||void 0===m?void 0:m.accountName)?`(${null===(u=e.manifest.accountInfo)||void 0===u?void 0:u.accountName})`:""}`,secondary:e.manifest.description}),a.createElement(P.Z,null,d)))}))),s())},q=e=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(U,Object.assign({},e)))),G=e=>{const{trackingId:t}=e,n=o.MetricsMap.boxModel.spacing,[r,c]=a.useState(!1),[s,m]=a.useState({email:"",profilePicture:"",userName:"",uuid:""}),[u,d]=a.useState(!1),[p,g]=a.useState(!1);return(0,o.useEffectOnce)((()=>{i.Z.systemBardeenAccountProfileGet().then((e=>{m(e)})),i.Z.systemBardeenAccountConsentEmailsGet().then((e=>{c(e)}))})),a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"My Bardeen",avatar:s.profilePicture,subTitle:"System Settings",actions:a.createElement(a.Fragment,null,a.createElement(o.BardeenModal,{variant:"popper",open:u,primaryButton:"Yes",secondaryButton:"No",footerVariant:"buttons",secondaryCallback:()=>d(!1),primaryCallback:function(){return i.Z.systemBardeenAccountDelete().then((()=>{const e=()=>{i.Z.systemBootStatusGet().then((()=>{e()})).catch((()=>{setTimeout((()=>{window.location.reload()}),1e3)}))};e()}))},title:"Are you sure you want to permanently delete your account including all your data, playbooks and triggers?"}),a.createElement(o.BardeenButton,{type:"flat",onClick:()=>d(!0)},"Delete Account"),a.createElement(o.BardeenModal,{variant:"popper",open:p,primaryButton:"Yes",secondaryButton:"No",footerVariant:"buttons",secondaryCallback:()=>g(!1),primaryCallback:function(){return i.Z.systemBardeenAccountLogout().then((()=>{const e=()=>{const t=i.Z.ping(),n=new Promise(((e,t)=>setTimeout(t,500)));Promise.race([t,n]).then((()=>{e()})).catch((()=>{setTimeout((()=>{window.location.reload()}),1e3)}))};e()}))},title:"Are you sure you want to log-out?"}),a.createElement(o.BardeenButton,{type:"flat",onClick:()=>g(!0)},"Logout"))}),a.createElement("div",{style:{padding:15}},a.createElement("p",null,"You are currently logged in as"," ",a.createElement("strong",null,s.userName," (",s.email,")"),"."),a.createElement("p",null,"Your Bardeen Analytics ID is: ",a.createElement("strong",null,t),". ",a.createElement("br",null)),a.createElement("hr",null),a.createElement("p",null,"Note, that for the Bardeen Beta release, we gather high level analytics information which helps us improve the product for you. ",a.createElement("br",null),"Specifically, we collect: ",a.createElement("br",null),"- What commands you run ",a.createElement("br",null),"- If a given command execution succeeds ",a.createElement("br",null),"- If a given command execution fails, and the error message of such failure. ",a.createElement("br",null),"We ",a.createElement("strong",null,"do not collect any personal or identifiable information"),", or any of the input arguments you add to the commands when executing or scheduling them. ",a.createElement("br",null),"Your privacy and security is our highest priority."),a.createElement("hr",null),a.createElement("div",{style:{marginBottom:"30px",marginTop:"30px"}},a.createElement(o.Title,{variant:"h2",color:"base-80"},"Product Updates"),a.createElement("div",{style:{marginBottom:`${n.l}px`}},a.createElement(o.Text,{variant:"small-body",color:"base-60"},"Send me very occasional emails about new features and updates."),a.createElement(o.BardeenSwitch,{checked:r,onChange:e=>{return t=e,i.Z.systemBardeenAccountConsentEmailsUpdate(t).then((()=>c(t))).catch((e=>{if((0,l.isBardeenError)(e))throw console.error(e),e;{const n=l.MarketingConsentUpdateError.from({originalError:e,email:s.email,consentToReceiveEmails:t});throw console.error(n),n}}));var t}}))))))};var V=n(58081);const Y={text:V.yE,password:V.hB,number:V.LR,checkbox:V.OA,select:V.uU,"select-multiple":V.hZ},J=e=>{const{value:t,config:n,onChange:r}=e,l=Y[n.widget.type];return l?a.createElement(l,{value:t,onChange:r,config:n}):a.createElement(o.BardeenAlert,{severity:"error"},`Could not find a widget with type "${n.widget.type}"`)},Q=e=>{const{value:t,onChange:n,config:r}=e;return r.fields?(l=r.fields,a.createElement("div",null,l.map((e=>a.createElement(J,{key:e.name,config:e,value:t[e.name],onChange:a=>((e,a)=>{const r=Object.assign({},t,{[e]:a});n(r)})(e.name,a)}))))):a.createElement("div",null,"Nothing to configure");var l},K=e=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:`${e.configManifest.name} Settings`,avatar:e.configManifest.icon,actions:a.createElement(a.Fragment,null,a.createElement(o.BardeenButton,{key:"cancel",onClick:e.onCancel},"Cancel"),",",a.createElement(o.BardeenButton,{key:"save",type:"primary",onClick:e.onCommit},"Save"))}),e.configError?a.createElement(o.BardeenAlert,{severity:"error"},e.configError):null,a.createElement(Q,{config:e.configManifest.config,value:e.value,onChange:e.onChange}))),X=e=>{const{list:t}=e;return a.createElement(M.Z,null,t.map((e=>a.createElement(N.Z,{key:e.uuid},a.createElement(A.Z,null,a.createElement(o.BardeenAvatar,{src:e.owner.icon})),a.createElement(I.Z,{primary:e.title,secondary:a.createElement("div",null,a.createElement(o.BardeenProgressBar,{value:e.progress}),a.createElement("div",null,e.message),e.journal.length>0?a.createElement(o.BardeenCollapse,{summary:"Show Journal"},a.createElement("pre",null,e.journal.join("\n"))):null)})))))},ee=e=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Background Queue",subTitle:"Jobs currently running in the background queue"}),a.createElement(X,Object.assign({},e)))),te=o.MetricsMap.boxModel.spacing,ne=(0,j.createUseStyles)({missingContent:{"&.MuiTimelineItem-missingOppositeContent":{"&::before":{content:"none"}}},invocationWrapper:{width:"100%",padding:`${te.l}px`,"& .vbh-primary-fields":{maxWidth:"500px"},"& .b-collapse-details":{flexDirection:"column"},"& .b-collapse-summary":{padding:`${te.s}px 0`}},errorDot:{borderColor:o.ColorMap.strawberry.base},successDot:{borderColor:o.ColorMap.mint.base}}),ae=e=>{const{onRemove:t,triggers:n}=e,[r,c]=a.useState(null),[s,m]=a.useState({}),u=ne(),d=a.useCallback(((e,t)=>{i.Z.triggerInvocationDetails(e,t).then((n=>{m(Object.assign(Object.assign({},s),{[`${e}-${t}`]:{loading:!1,blocks:n.dataBlocks,error:""}}))})).catch((n=>{m(Object.assign(Object.assign({},s),{[`${e}-${t}`]:{loading:!1,blocks:[],error:(0,l.unknownToString)(n)}}))}))}),[s]),p=e=>a.createElement("div",{className:u.invocationWrapper},a.createElement("p",null,"Active since ",a.createElement(o.DateLabel,{date:e.startedTs})),a.createElement(o.TriggerInvocationList,{triggerStatus:e,invocationDetailsMap:s,requestInvocationDetails:d}));return a.createElement(a.Fragment,null,a.createElement(M.Z,null,n.map((e=>{const t=e.title.substr(0,1).toUpperCase()+e.title.substr(1);return a.createElement(N.Z,{key:e.uuid},a.createElement(A.Z,null,a.createElement(o.BardeenAvatar,{src:e.manifest.icon,variant:"square"})),a.createElement(I.Z,{primary:t,secondary:p(e)}),a.createElement(P.Z,null,a.createElement(o.BardeenButton,{color:o.ColorMap.strawberry.base,icon:{icon:"TrashBinOutline"},onClick:()=>c(e.uuid),size:"s"})))}))),a.createElement(o.BardeenModal,{variant:"popper",open:!!r,primaryButton:"Yes",secondaryButton:"No",footerVariant:"buttons",secondaryCallback:()=>c(null),primaryCallback:()=>{c(null),t(r)},title:"Are you sure you want to remove this trigger?"}))},re=e=>a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Registered Triggers",subTitle:"A list of all registered triggers that are listening for WHEN events"}),a.createElement(ae,Object.assign({},e))));var le=n(49438),oe=n(91256),ie=n(37390),ce=n(58987),se=n(89571),me=n(15584),ue=n(97485),de=n(62774);const pe=e=>{const{command:t}=e;return a.createElement("table",null,a.createElement("tbody",null,a.createElement("tr",null,a.createElement("th",{style:{width:"100px"}},"Name:"),a.createElement("td",null,a.createElement("code",null,t.name))),a.createElement("tr",null,a.createElement("th",null,"Description:"),a.createElement("td",null,t.description||"(Not specified)")),a.createElement("tr",null,a.createElement("th",null,"Keywords:"),a.createElement("td",null,t.keywords.length?t.keywords.join(", "):"(None)"))))},ge=e=>{const{type:t,onClick:n}=e;return a.createElement(o.BardeenTooltip,{headline:t.desc.description,title:`${t.name} (${t.facets.join(", ")})`},a.createElement("div",{style:{cursor:"pointer"},onClick:()=>n(t.facets)},a.createElement("div",{style:{display:"inline-block",backgroundImage:`url(${t.desc.icon})`,backgroundSize:"contain",width:"18px",height:"18px",verticalAlign:"middle",marginRight:"4px"}}),t.desc.label||t.name))},Ee=(0,c.Z)({commandTag:{marginRight:o.MetricsMap.boxModel.spacing.base}}),ye=e=>{const t=Ee();if("string"==typeof e.token)return a.createElement("span",{className:`${t.commandTag} command-tag-beginning`},e.token);if(e.token.argTypes){const{types:n}=e.inspection.index,r=a.createElement("div",null,e.token.argTypes.map(((t,r)=>a.createElement(ge,{key:r,onClick:e.onClick,type:n[t]}))));return a.createElement(o.BardeenTooltip,{mode:"dark",title:r},a.createElement("strong",{className:`${t.commandTag} command-tag-argument`},e.token.label))}return a.createElement("span",{className:`${t.commandTag} command-tag-keyword`},e.token.label)},he=(0,c.Z)({root:{"& > *":{borderBottom:"unset"}}});function be(e){const{plugins:t,types:n}=e.inspection.index,[r,l]=(0,a.useState)([]),[i,c]=(0,a.useState)(""),[s,m]=(0,a.useState)(0),u=a.useMemo((()=>i?e.inspection.commands.filter((e=>{var a;const r=e.expression.map((e=>e.label.toLowerCase())).join(" "),l=i.toLowerCase();return!!(r.includes(l)||e.retTypes.some((e=>{var t;return null===(t=n[e])||void 0===t?void 0:t.facets.includes(l)}))||e.yieldTypes.some((e=>{var t;return null===(t=n[e])||void 0===t?void 0:t.facets.includes(l)}))||(null===(a=t[e.plugin])||void 0===a?void 0:a.name.toLowerCase().includes(l)))})):e.inspection.commands),[i,e.inspection.commands,n,t]),d=a.useMemo((()=>r.length?u.filter((e=>{const t=e.retTypes.some((e=>r.every((t=>{var a;return null===(a=n[e])||void 0===a?void 0:a.facets.includes(t)})))),a=e.yieldTypes.some((e=>r.every((t=>{var a;return null===(a=n[e])||void 0===a?void 0:a.facets.includes(t)}))));return t||a})):u),[r,u,n]);return d.length/10<s&&m(Math.floor(d.length/10)),a.createElement("div",null,a.createElement(o.BardeenInput,{fullWidth:!0,isSearchable:!0,placeholder:"Search command ...",size:"l",value:i,onChange:c}),a.createElement(le.Z,{component:"div",count:d.length,onPageChange:(e,t)=>m(t),page:s,rowsPerPage:10,rowsPerPageOptions:[10]}),a.createElement(oe.Z,null,a.createElement(ie.Z,null,a.createElement(ce.Z,null,a.createElement(se.Z,null,a.createElement(me.Z,{width:"66"}),a.createElement(me.Z,{width:"66"},"From"),a.createElement(me.Z,{width:"76"},"Type"),a.createElement(me.Z,null,"Expression"),a.createElement(me.Z,{width:"200"}," Returns"))),a.createElement(ue.Z,null,d.slice(10*s,10*(s+1)).map((t=>a.createElement(ve,{inspection:e.inspection,key:t.name,row:t,setFilterReturnFacets:l})))))))}const ve=({inspection:e,setFilterReturnFacets:t,row:n})=>{const[r,l]=a.useState(!1),{plugins:i,types:c}=e.index,s=i[n.plugin],m=he();return a.createElement(a.Fragment,null,a.createElement(se.Z,{className:m.root},a.createElement(me.Z,null,a.createElement(o.BardeenButton,{"aria-label":"expand row",type:"flat",icon:{icon:r?"ArrowUpBold":"ArrowDownBold"},onClick:()=>l(!r)})),a.createElement(me.Z,{component:"th",scope:"row"},a.createElement(o.BardeenTooltip,{headline:s.name,placement:"right",title:s.description},a.createElement("div",null,a.createElement(o.BardeenIcon,{size:24,icon:s.icon})))),a.createElement(me.Z,null,a.createElement("strong",null,String(n.type).toUpperCase())),a.createElement(me.Z,null,a.createElement("span",null,a.createElement(ye,{onClick:t,inspection:e,token:n.type}),n.expression.map(((r,l)=>a.createElement(ye,{onClick:t,inspection:e,key:`${n.key}_${r.label}_${l}`,token:r}))))),a.createElement(me.Z,null,n.retTypes.map(((e,n)=>a.createElement(ge,{onClick:t,key:`r${n}`,type:c[e]}))).concat(n.yieldTypes.map(((e,n)=>a.createElement(ge,{onClick:t,key:`y${n}`,type:c[e]})))))),a.createElement(se.Z,null,a.createElement(me.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6},a.createElement(O.Z,{in:r,timeout:"auto",unmountOnExit:!0},a.createElement(de.Z,{margin:1},a.createElement("div",{key:n.key,style:{marginLeft:"124px"}},a.createElement(pe,{command:n})))))))},fe=()=>{const[e,t]=a.useState(null);return(0,o.useEffectOnce)((()=>{i.Z.commandsEnumerate().then(t)})),a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Commands",subTitle:"List of all commands in the system"}),e?a.createElement(be,{inspection:e}):a.createElement("span",null,"Loading...")))};var ke=n(34005),Ce=n(46782),Be=n(5578),we=n(74392),xe=function(e,t,n,a){return new(n||(n=Promise))((function(r,l){function o(e){try{c(a.next(e))}catch(e){l(e)}}function i(e){try{c(a.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};const Se=e=>xe(void 0,void 0,void 0,(function*(){if(e)return i.Z.playbookGetDependencies(e)})),Te=a.memo((e=>{const{meta:t,onClick:n}=e,{color:r,description:c="",id:s=""}=t,[m,u]=(0,Be.d)(),[d,p]=(0,we.i)({onAfterDelete:e.onChange}),[,{openSnackbar:g}]=(0,ke.E0)(),E=a.useMemo((()=>[...Ze("user"===t.origin,{name:"Download",id:"pb_card_download",icon:{icon:"DownloadOutline"},onClick:()=>((e,t)=>{i.Z.dedangle((()=>xe(void 0,void 0,void 0,(function*(){return(0,Ce.saveAs)(new Blob([yield i.Z.playbookExport(e)],{type:"application/json"}),`${t.toLocaleLowerCase().replace(/[^a-z0-9-_]/g,"-")}.bardeen`)}))))})(s,t.name)}),{name:"Share playbook",id:"pb_share_playbook",icon:{icon:"PaperplaneOutline"},onClick:()=>u(s)}]),[s,t,u]),y=n?()=>n(t):void 0,h=t.canDelete?()=>p(t):void 0,b=a.useCallback((()=>u(s)),[s,u]);return a.createElement(a.Fragment,null,a.createElement(o.PlaybookCard,{color:Array.isArray(r)?r:["melon","raspberry"],description:c,fadeIn:!0,getPBDependencies:Se,id:s,integrationIcons:t.integrationIcons,menuItems:E,onClick:y,onDelete:h,onPinToggle:()=>{i.Z.dedangle(i.Z.playbookSetFavorite(s,!t.favorite).catch((e=>{g({message:`Could not toggle playbook favorite state: ${(0,l.unknownToString)(e)}`,variant:"error"})})).finally(e.onChange))},onClickPlaybookInfo:()=>i.Z.openPlaybooks(s),onSharePlaybook:b,pinned:t.favorite,running:e.running,title:t.name,tooltipOpen:e.tooltipOpen}),m,d)})),Ze=(e,t)=>e?[t]:[],Me=o.MetricsMap.boxModel.spacing,Ne=(0,c.Z)({container:{marginBottom:"30px"},grid:{display:"flex",flexWrap:"wrap",gap:`${Me.s}px`},loadMoreButton:{width:"100%",marginTop:`${Me.l}px`,marginBottom:`${Me.l}px`,"&:hover":{color:o.ColorMap.bardeen[50]}},subtitle:{marginBottom:`${Me.l}px`},icon:{marginRight:`${Me.s}px`}}),Ae=e=>{const{filter:t,filterText:n,onChange:r,onPlaybookClick:c,pageLimit:s=10,subtitle:m,title:u}=e,[d,p]=a.useState([]),[g,E]=a.useState(!1),[y,h]=a.useState(!0),[b,v]=a.useState(0),f=a.useRef([]),[,{openSnackbar:k}]=(0,ke.E0)(),C=Ne(),B=a.useCallback(((e,t,n)=>{E(!0),i.Z.dedangle(i.Z.playbookQuery(Object.assign(Object.assign({},e),{expression:t,offset:n,limit:s})).then((e=>{const t=n>0?f.current.slice():[];t.splice(n,0,...e),f.current=t,p(t),h(e.length===s),v(n+e.length)})).catch((e=>{k({message:`Could not query playbooks: ${(0,l.unknownToString)(e)}`})})).finally((()=>{E(!1)})))}),[k,s]);a.useEffect((()=>{B(t,n,0)}),[B,t,n]);const w=a.useCallback((()=>{B(t,n,b)}),[B,t,n,b]),x=a.useMemo((()=>d.map((e=>a.createElement(Te,{key:`${e.origin}:${e.id}`,meta:e,onClick:()=>c(e),onChange:r})))),[r,c,d]);return g||d.length?a.createElement("div",{className:C.container},a.createElement(o.Title,{variant:"h2",color:"base-80"},u),a.createElement("div",{className:C.subtitle},a.createElement(o.Text,{variant:"small-body",color:"base-60"},m)),a.createElement("div",{className:C.grid},x),y?a.createElement("div",null,a.createElement(o.BardeenButton,{type:"neumorphOutline",className:C.loadMoreButton,size:"l",onClick:w},"Load more...")):null):null},Ie=o.MetricsMap.boxModel.spacing,Oe=(0,c.Z)({descriptionStyle:{color:o.ColorMap.base[60],marginTop:`${Ie.l}px`,marginBottom:`${Ie.l}px`},integrationIcons:{display:"flex",marginTop:Ie.s-3+"px",marginBottom:`${Ie.l}px`,gap:`${Ie.base}px`}}),Pe=o.MetricsMap.boxModel.spacing,$e=(0,c.Z)({tokenLine:{display:"flex",padding:Pe.s-3+"px",marginBottom:`${Pe.s}px`},tokenArrow:{paddingTop:Pe.s-3+"px",marginRight:Pe.s-3+"px"},tokenCommandType:{marginRight:`${Pe.base}px`,"& $label":{marginRight:0}},tokenCommandArgs:{display:"flex",flexWrap:"wrap",maxWidth:"410px"},label:{margin:`${Pe.base}px`}}),Fe=e=>{const{commands:t}=e,n=$e(),r=a.useCallback(((e,t)=>{const n=(0,o.getTokenName)(e.color).toLocaleLowerCase();switch(!0){case"iconType"in e&&"avatar"===e.iconType:return"user";case Boolean(t):return"result-block";case"playbookargument"===n:return"playbook-argument";case"value"===n:return"argument";case"variable"===n:return"playbook";default:return n}}),[]),l=a.useCallback((e=>{const{itemColor:t}=(0,o.getTokenColors)(e.color),l=null==e?void 0:e.icon,i=r(e,l),c=(e=>e.label?e.label:"string"==typeof e.value?e.value:"UNKNOWN TOKEN")(e),s="playbook"===i||"playbook-argument"===i;return a.createElement(o.BardeenLabel,{className:n.label,type:"command",commandType:i,size:"s",icon:l,color:s?t:void 0},c)}),[n.label,r]);return a.createElement(a.Fragment,null,t.map(((e,t)=>a.createElement("div",{key:`cmd-${t}`,className:n.tokenLine},a.createElement("div",{className:n.tokenArrow},a.createElement(o.BardeenIcon,{icon:{icon:"ArrowRightOutline"}})),a.createElement("div",{className:n.tokenCommandType},l(e[0])),a.createElement("div",{className:n.tokenCommandArgs},e.slice(1).map((e=>l(e))))))))},Le=e=>{const{playbook:t}=e,n=Oe(),r=a.useMemo((()=>t.spec.plugins.map(((e,n)=>{const r=t.integrationIcons[n];return a.createElement(o.BardeenLabel,{icon:r,key:e.instanceId,type:"command",commandType:"result-block"},e.name)}))),[t]);return a.createElement("div",null,a.createElement("div",{className:n.descriptionStyle},t.description?a.createElement(o.RichText,{text:t.description,format:"markdown"}):a.createElement("div",null,"(No description provided)")),a.createElement("div",{className:n.integrationIcons},r),a.createElement("div",null,a.createElement(o.Title,{variant:"h3"},"Commands"),a.createElement(Fe,{commands:t.commandTokens||[]})))},Re=o.MetricsMap.boxModel.spacing,He=(0,c.Z)({"@global":{body:{padding:0,margin:0},"#main":{minHeight:"100%"},".settings-panel-background":{backgroundColor:o.ColorMap.base.white}},layout:{display:"flex",flex:"auto",flexDirection:"column",minHeight:"100vh"},settingsLogo:{padding:18},settingsMenu:{marginTop:`${Re.base}px`},item:{padding:`${Re.m}px`,"&:not(:last-child)":{marginBottom:`${Re.s}px`},color:o.ColorMap.base[30],cursor:"pointer","&:hover":{color:o.ColorMap.base.white}},activeItem:{backgroundColor:o.ColorMap.bardeen.base,color:o.ColorMap.base.white},settingsLayout:{transition:"all 0.2s"},settingsHeader:{height:"64px",background:o.ColorMap.base[90],position:"sticky",top:0,zIndex:100},marginBottom:{"&.MuiTextField-root":{marginBottom:"15px"}},btnWrapper:{display:"flex",alignItems:"center"},btn:{"&:not(:last-child)":{marginRight:`${Re.s}px`}},pageHeaderTitleWrapper:{display:"flex",alignItems:"center"},pageHeaderTitle:{flex:1,marginLeft:`${Re.s}px`},spinnerWrapper:{display:"flex",alignItems:"center",justifyContent:"center"}}),We=/playbook=(.*)/,je={scopes:["catalog.any","personal","favorite.only"]},De={scopes:["personal"]},_e={scopes:["catalog.any","favorite.exclude"]},ze=()=>{const[e,t]=a.useState(""),[n,r]=a.useState(null),[c,s]=a.useState(""),[m,u]=a.useState({}),d=(0,k.TH)(),[,{openSnackbar:p}]=(0,ke.E0)(),g=He();a.useEffect((()=>{const e=We.exec(d.search);if(e){const t=e[1];i.Z.dedangle(i.Z.playbookGet(t).then((e=>{r(e)})))}else r(null)}),[d.search]),a.useEffect((()=>{i.Z.systemSettingsGet().then(u)}),[]);const E=a.useCallback((()=>{s(Date.now().toString())}),[]),y=a.useCallback((()=>{r(null)}),[]),h=a.useCallback((()=>{i.Z.dedangle(i.Z.playbookCatalogReload().then((()=>{p({message:"Playbook catalog synchronised",variant:"success"}),E()})).catch((e=>{p({message:`Could not synchronise catalog: ${(0,l.unknownToString)(e)}`,variant:"error"})})))}),[p,E]),b=a.useCallback((e=>{const t=e.target.files[0],n=new FileReader;return n.readAsArrayBuffer(t),n.onload=()=>{const e=n.result,t=(new TextDecoder).decode(e);i.Z.playbookImport(t).then((e=>{p({message:`Successfully imported ${e.name}`,variant:"success"}),E()})).catch((e=>{p({message:`Could not import playbook: ${(0,l.unknownToString)(e)}`,variant:"error"})}))},!1}),[p,E]),v=a.useCallback((()=>{const e=document.createElement("input");e.type="file",e.onchange=b,e.click()}),[b]),f=a.useMemo((()=>a.createElement(a.Fragment,null,a.createElement(o.BardeenButton,{size:"m",type:"neumorphOutline",icon:{icon:"FullArrowUpOutline"},onClick:v},"Import playbook"))),[v]),C=a.useMemo((()=>a.createElement(o.BardeenIconButton,{tooltip:"Synchronize now with the remote catalog",size:"m",type:"flat",icon:{icon:"RefreshOutline"},onClick:h})),[h]),B=a.useMemo((()=>a.createElement("div",{className:g.btnWrapper},a.createElement("div",{className:g.btn},f),a.createElement("div",{className:g.btn},C))),[g,f,C]);return a.createElement("div",{style:{margin:"0 16px"}},a.createElement("div",{className:"settings-panel-background",style:{padding:24,minHeight:360}},a.createElement(o.BardeenPageHeader,{title:"Playbooks Catalog",subTitle:"Lists all available playbooks",actions:B}),a.createElement(o.BardeenInput,{className:g.marginBottom,defaultValue:"",fullWidth:!0,isSearchable:!0,placeholder:"Search playbooks ...",size:"l",onChange:t,value:e}),a.createElement(Ae,{filter:je,filterText:e,key:`fav-${c}`,onChange:E,onPlaybookClick:r,settings:m,subtitle:"Playbooks that you have pinned in the pop-up window",title:"Pinned"}),a.createElement(Ae,{filter:De,filterText:e,key:`my-${c}`,onChange:E,onPlaybookClick:r,settings:m,subtitle:"The playbooks saved in your account",title:"My Playbooks"}),a.createElement(Ae,{filter:_e,filterText:e,key:`all-${c}`,onChange:E,onPlaybookClick:r,settings:m,subtitle:"The public playbooks provided by BARDEEN",title:"Catalog"})),a.createElement(o.BardeenModal,{open:null!=n,title:n?n.name:"Playbook Details",footerVariant:"buttons",primaryButton:"Close",primaryCallback:y},n?a.createElement(Le,{playbook:n}):null))};var Ue=n(28871),qe=n(50405);const Ge=()=>{const[e,t]=a.useState(""),[n,r]=a.useState(!1),[c,s]=a.useState({}),[m,u]=a.useState({}),[d,p]=a.useState({}),[g,E]=a.useState({}),[y,h]=a.useState([]),[b,v]=a.useState([]),[f,B]=a.useState([]),[x,S]=a.useState([]),[T,M]=a.useState([]),[N,A]=a.useState(!1),[I,O]=a.useState(!1),[P,$]=a.useState(""),[F,L]=a.useState(""),[R,W]=a.useState(""),[j,D]=a.useState(0),[,{openSnackbar:_}]=(0,ke.E0)();let U;const V=(0,k.TH)(),Y=(0,k.s0)(),J=He(),Q=a.useCallback((()=>Promise.all([i.Z.integrationListInstances(),i.Z.integrationListFactories(),i.Z.integrationListFailed()]).then((e=>{h(e[0]),v(e[1]),B(e[2])}))),[]),X=a.useCallback((()=>(i.Z.getTimeSaved().then((e=>{D(e)})),Promise.all([i.Z.triggersList(),i.Z.progressListActiveOperations()]).then((e=>{M(e[0]),S(e[1])})))),[]),te=a.useCallback((e=>{A(!0),$(""),L(e.id),u(e.manifest),E(e.config)}),[]),ne=a.useCallback((e=>{O(!0),p(e)}),[]),ae=a.useCallback((()=>{O(!1)}),[]),le=a.useCallback((e=>i.Z.integrationDeactivate(e).then((()=>Q())).catch((e=>{const t=l.GenericError.from({originalError:e});console.error(t);const n=t.userHint?`${t.message} ${t.userHint}`:t.message;_({message:`Could not deactivate plugin: ${n}`,variant:"error"})}))),[_,Q]),oe=a.useCallback((e=>i.Z.triggersRemove(e).then((e=>{M(e)}))),[]),ie=a.useCallback((e=>(t(""),r(!0),s(e),i.Z.integrationActivate(e.id).then((()=>Q().then((()=>(r(!1),!0))))).catch((e=>(t(e.toString()),!1))))),[Q]),ce=a.useCallback((()=>{i.Z.integrationConfigApply(F,g).then((()=>($(""),A(!1),Q()))).catch((e=>{$(e.toString())}))}),[F,g,Q]),se=a.useCallback((e=>{E(e)}),[]),me=a.useCallback((()=>{A(!1)}),[]),ue=a.useCallback((()=>{r(!1)}),[]),de=a.useCallback((e=>{return t=void 0,n=void 0,r=function*(){return yield e.trackingGetId().then((e=>e)).catch((()=>""))},new((a=void 0)||(a=Promise))((function(e,l){function o(e){try{c(r.next(e))}catch(e){l(e)}}function i(e){try{c(r.throw(e))}catch(e){l(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a((function(e){e(n)}))).then(o,i)}c((r=r.apply(t,n||[])).next())}));var t,n,a,r}),[]),pe=a.useCallback((()=>a.createElement(o.BardeenModal,{open:n,title:c.name},e?a.createElement(o.BardeenResult,{variant:"error",title:"Failed to add",body:e,actions:a.createElement(o.BardeenButton,{type:"primary",key:"console",onClick:ue},"Close")}):a.createElement("div",{className:J.spinnerWrapper},a.createElement(o.BardeenSpinner,null)))),[e,n,c.name,J,ue]),ge=a.useCallback((()=>a.createElement(o.BardeenModal,{open:I,title:d.name,footerVariant:"buttons",secondaryButton:"Close",secondaryCallback:ae},a.createElement("p",null,d.description))),[d.description,d.name,I,ae]);(0,o.useEffectOnce)((()=>(Q(),X(),U=window.setInterval(X,500),de(i.Z).then((e=>{W(e)})),()=>{window.clearInterval(U)})));const Ee=(0,o.useMemoCompare)((()=>T),((e,t)=>w()(e,t))),ye=(0,o.useMemoCompare)((()=>x),((e,t)=>w()(e,t))),he=a.useMemo((()=>[{key:"root",name:"My Integrations",route:"/"},{key:"catalog",name:"Integration Catalog",route:"/catalog"},{key:"commands",name:"Commands",route:"/commands"},{key:"playbooks-catalog",name:"Playbooks Catalog",route:"/playbooks-catalog"},{key:"triggers",name:"Triggers",route:"/triggers"},{key:"queue",name:"Background Queue",route:"/queue"},{key:"errors",name:"Errors",route:"/errors",component:a.createElement(z,null)},{key:"settings",name:"Settings",route:"/settings"}]),[]),be=a.useMemo((()=>V.pathname.split("/")[1]||"root"),[V]),ve=a.useMemo((()=>{const e=a.createElement(a.Fragment,null,a.createElement(q,{plugins:y,pluginsFailed:f,onRemove:le,onShowSettings:te}),N?a.createElement(k.Fg,{to:`/integration/${m.id}`}):null),t=a.createElement(a.Fragment,null,a.createElement(K,{configManifest:m,configError:P,value:g,onChange:se,onCommit:ce,onCancel:me}),N?null:a.createElement(k.Fg,{to:"/"})),n=a.createElement(Z,{plugins:b,onActivate:ie,onShowMore:ne}),r=a.createElement(ze,{handlePluginActivate:ie,handlePluginShowMore:ne}),l=a.createElement(re,{triggers:Ee,onRemove:oe});return a.createElement(qe._,null,a.createElement(k.Z5,null,a.createElement(k.AW,{path:"/",element:e}),a.createElement(k.AW,{path:"/integration/:integration",element:t}),a.createElement(k.AW,{path:"/catalog",element:n}),a.createElement(k.AW,{path:"/playbooks-catalog",element:r}),a.createElement(k.AW,{path:"/settings",element:a.createElement(G,{trackingId:R})}),a.createElement(k.AW,{path:"/errors",element:a.createElement(H,null)}),a.createElement(k.AW,{path:"/queue",element:a.createElement(ee,{list:ye})}),a.createElement(k.AW,{path:"/triggers",element:l}),a.createElement(k.AW,{path:"/commands",element:a.createElement(fe,null)})))}),[P,m,N,g,ie,me,ce,se,le,oe,ne,te,ye,Ee,y,b,f,R]);return a.createElement("div",{className:"wrapper"},a.createElement("div",{className:J.layout},a.createElement("div",{style:{overflow:"auto",height:"100vh",position:"fixed",left:0,width:200,background:o.ColorMap.base[90]}},a.createElement("div",{className:J.settingsLogo},a.createElement(o.BardeenIcon,{size:24,icon:{icon:"BardeenLogoV2"}})),a.createElement("div",{className:J.settingsMenu},he.map((e=>{const t=be===e.key?J.activeItem:"";return a.createElement("div",{className:(0,C.Z)(J.item,t),key:e.key,onClick:()=>{var t;Y(e.route),Q(),null===(t=e.onClick)||void 0===t||t.call(e,e.key)}},e.name," ",e.component||null)})))),a.createElement("div",{className:J.settingsLayout,style:{marginLeft:200}},a.createElement("div",{className:J.settingsHeader},a.createElement(o.BardeenButton,{mode:"dark",style:{float:"right",marginTop:15,marginRight:15}},"Total time saved: ",(0,l.timeSavedFormatted)(j))),ve),pe(),ge()),a.createElement(Ue.B,null))},Ve=()=>a.createElement(f.UT,null,a.createElement(Ge,null)),Ye=(0,c.Z)({previewTableHeader:{padding:"10px",backgroundColor:"#eee",color:"#54575c",fontSize:"14px",fontWeight:600,textAlign:"center"}}),Je=e=>{const{dataUrl:t}=e,[n,r]=a.useState(!0),[l,i]=a.useState(!1),[c,s]=a.useState([]),[m,u]=a.useState([]),[d,p]=a.useState(null),g=Ye();return(0,o.useEffectOnce)((()=>{fetch(t).then((e=>e.json())).then((e=>{r(!1),s(e.rows),u(e.columns.map((e=>({headerName:e.title,field:e.name,flex:1,minWidth:180}))))})).catch((()=>{r(!1)}))})),a.createElement(a.Fragment,null,a.createElement("div",{className:g.previewTableHeader},n?a.createElement("span",null,"Loading ..."):a.createElement("span",null,a.createElement(o.TableOutline,null)," Viewing Full Table")),a.createElement(o.BardeenTable,{loading:n,columns:m,rows:c}),a.createElement(o.BardeenModal,{open:l,title:"View Cell",secondaryButton:"Hide",footerVariant:"buttons",secondaryCallback:()=>{i(!1)}},a.createElement(o.RichText,{text:d||"",format:"html"})))},Qe=n.p+"52a3d99382b35ca8a7fcc07890e1cc61.svg",Ke=n.p+"6331265545c1bb210c6acc948997f356.png",Xe=()=>{const e=a.useRef(""),t=a.useRef("");let n=null;const r=p(),[l,i]=a.useState({client_id:"",client_secret:""});return(0,o.useEffectOnce)((()=>{const a=String(window.location.hash).substr(1),r=JSON.parse(atob(a));e.current=r.normal,t.current=r.proxy;const l=new URLSearchParams(window.location.search.substr(1)).get("state");l&&(n=JSON.parse(atob(l)))})),a.createElement("div",{className:r.promptsForm},a.createElement("div",{className:r.logoHeader},a.createElement(o.BardeenAvatar,{size:52,src:Qe,variant:"square"}),a.createElement("span",{className:r.logoTitle},"Google Mail Authentication")),a.createElement(o.BardeenCard,{className:r.card},a.createElement("div",null,a.createElement("h2",null,"Approach 1: Bardeen Credentials"),a.createElement(o.Text,{variant:"body"},"Use this approach if you are a G-suite user."),a.createElement("div",null,a.createElement(o.BardeenButton,{onClick:()=>{const e=new URL(t.current),a=new URL(e.searchParams.get("redirect"));a.searchParams.set("state",btoa(JSON.stringify(n))),e.searchParams.set("redirect",a.toString()),window.location.href=e.toString()}},a.createElement(o.BardeenAvatar,{size:16,src:Ke,variant:"square",style:{marginRight:"7px"}}),"Authenticate with google"))),a.createElement("div",null,a.createElement("h2",null,"Approach 2: Custom Credentials"),a.createElement(o.Text,{variant:"body"},'Use this approach if you are a regular Gmail user. I.e. your email ends in "@gmail" or "@googlemail".'),a.createElement(o.Text,{variant:"body"},"Watch our quick"," ",a.createElement("a",{href:"https://bardeen.ai/lessons/integrating-gmail",target:"_blank"},"video guide")," ","on how to make this approach work."),a.createElement("form",{onSubmit:()=>{let t={client_id:l.client_id.trim(),client_secret:l.client_secret.trim()};n&&(t=Object.assign(Object.assign({},t),n));const a=btoa(JSON.stringify(t));return e.current=e.current.replace("{{client_id}}",t.client_id),setTimeout((()=>{window.location.href=`${e.current}&state=${encodeURIComponent(a)}`}),0),!1},style:{textAlign:"left"},className:r.form},a.createElement(o.BardeenFormItem,{labelText:"Client ID"},a.createElement(o.BardeenInput,{fullWidth:!0,onChange:e=>i((t=>Object.assign(Object.assign({},t),{client_id:e}))),value:l.client_id})),a.createElement(o.BardeenFormItem,{labelText:"Client Secret"},a.createElement(o.BardeenInput,{fullWidth:!0,onChange:e=>i((t=>Object.assign(Object.assign({},t),{client_secret:e}))),value:l.client_secret})),a.createElement(o.BardeenButton,{type:"primary",htmlType:"submit"},"Go!"))),a.createElement(o.Text,{variant:"body"},"If you have any questions, don't hesitate to contact us via"," ",a.createElement("a",{href:"mailto:support@bardeen.ai",target:"_blank"},"support@bardeen.ai"),".")))};function et(e,t,n={}){(0,i.k)(t);const l=document.querySelector("#main");if(!l)return console.error("Could not find #main");(0,r.render)(a.createElement(o.BardeenStyleProvider,null,a.createElement(e,Object.assign({},n))),l)}},34005:(e,t,n)=>{n.d(t,{j1:()=>m,nb:()=>u,mF:()=>d,E0:()=>p,ZP:()=>g});var a=n(2784),r=n(10188),l=(n(13966),n(34073),n(25038)),o=n(32384),i=n(7905),c=n(26304),s=n(29236);const m=(0,r.Z)(a,o.n,l.N),u=(0,r.Z)(a,i.M,i._),d=(0,r.Z)(a,c.Qx,c.r_),p=(0,r.Z)(a,s.A,s.N),g=m}}]);
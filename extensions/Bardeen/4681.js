"use strict";(self.webpackChunkbardeen_browser_extension=self.webpackChunkbardeen_browser_extension||[]).push([[4681],{74681:(e,t,s)=>{s.r(t),s.d(t,{InteractivePlaybookButton:()=>a});var i=s(68796);class a{constructor(e){this.eventListenerCallbacks={},this.elementsWithListeners=[],this.retries=0,this.playbookIds=[],this.api=e}exec(){return this.getActivePlaybooks().then((()=>{this.retries=0,this.execBardeenInteractive()})).catch((e=>{this.retries=this.retries+1,this.retries<=3&&setTimeout((()=>{this.exec().catch((e=>console.log("Failed to get active playbooks: ",(0,i.unknownToString)(e))))}),1e3)}))}getActivePlaybooks(){return this.api.playbookQuery({scopes:["catalog.ready","personal"]}).then((e=>{this.playbookIds=e.map((e=>e.id))}))}execBardeenInteractive(){const e=document.querySelectorAll("[data-bardeen-playbook-id]");Array.from(e).forEach((e=>{const t=e.getAttribute("data-bardeen-playbook-id"),s=e.getAttribute("data-bardeen-playbook-url");this.attachListener(e,s&&""!=s?`url:${s}`:`id:${t}`),this.setActiveStyle(e,t)}))}setActiveStyle(e,t){const s=e.classList.contains("bardeen-interactive-active");this.playbookIds.includes(t)?s||e.classList.add("bardeen-interactive-active"):s&&e.classList.remove("bardeen-interactive-active")}attachListener(e,t){this.elementsWithListeners.includes(e)||(this.elementsWithListeners.push(e),this.eventListenerCallbacks[t]=e=>{e.preventDefault(),e.stopPropagation(),this.activatePlaybook(t)},e.addEventListener("click",this.eventListenerCallbacks[t]))}activatePlaybook(e){return this.api.playbookRemoteActivate(e).then((()=>this.exec())).catch((e=>{alert(`Playbook could not be installed: ${(0,i.unknownToString)(e)}`)}))}}}}]);